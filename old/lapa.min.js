if(!window.LaPa){window.LaPa={'version':{'major':2,'minor':8,'build':463},'loadBegin':new Date().getTime(),'debug':true,'extensions':{},'PAGE':{},'JS':{},'CSS':{},'CONF':{'runScriptsAsFuncContainer':true,'legacyPages':true},'STACK':{},'log':function(a,b,c){if(LaPa['debug']){time=new Date().getTime()-LaPa.loadBegin;console.log((c?'':'['+time+'] ')+(b?'['+b+'] ':'')+a)}},'rand':function(a){a=a?a:8;var b="";var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<a;i++)b+=c.charAt(Math.floor(Math.random()*c.length));return b},'errorHandler':function(a,b,c,d,e){if(!LaPa.errorLog)LaPa.errorLog=[];if(LaPa.errorLog[a]){LaPa.errorLog[a].count++}else{LaPa.errorLog[a]={'message':a,'source':b,'lineNumber':c,'column':d,'errorObj':e,'count':0}}if(!LaPa.CONF.hideErrors){if(LaPa.oldErrorHandler){}}return true},'pageQuery':function(){var a,pl=/\+/g,search=/([^&=]+)=?([^&]*)/g,decode=function(s){return decodeURIComponent(s.replace(pl," "))},query=window.location.search.substring(1);params={};while(a=search.exec(query)){params[decode(a[1])]=decode(a[2])}return params}(),'createExtension':function(a,b,c,d){if(!a)return false;LaPa.extensions[a]={};if(b)LaPa.extensions[a]['name']=b;if(c)LaPa.extensions[a]['init']=c;if(d)LaPa.extensions[a]['version']=d;LaPa.log((b?b:a)+' registered','EXTENSION');if(LaPa.extensionsInitialised)LaPa.loadExt(a)},'loadExt':function(a){if(a){ext=LaPa.extensions[a];if(ext.init){ext.init()}LaPa.log((ext.name?ext.name:i)+(ext.version?(' v.'+ext.version.major+'.'+ext.version.minor+' build '+ext.version.build):'')+' initialised','EXTENSION')}else{LaPa.extensionsInitialised=true;for(i in LaPa.extensions){ext=LaPa.extensions[i];if(ext.init){ext.init()}LaPa.log((ext.name?ext.name:i)+(ext.version?(' v.'+ext.version.major+'.'+ext.version.minor+' build '+ext.version.build):'')+' initialised','EXTENSION')}}},'history':function(e){if(e.state){id=e.state.id;LaPa.log('located to '+id,'HISTORY',true);if(id==LaPa.currentPage){history.back()}else{LaPa.page(id)}}},'fixJSforDB':function(){jsList=Object.keys(LaPa.JS);exportJS={};for(i in jsList){exportJS[jsList[i]]={'body':LaPa.JS[jsList[i]].body}}return exportJS},'saveDB':function(a){if(a){data=LaPa[a];if(a=='JS')data=LaPa.fixJSforDB();localStorage[a]=JSON.stringify(data);LaPa.log('Saved '+a,'LocalStorage')}else{localStorage['CONF']=JSON.stringify(LaPa['CONF']);localStorage['JS']=JSON.stringify(LaPa.fixJSforDB());localStorage['CSS']=JSON.stringify(LaPa['CSS']);localStorage['PAGE']=JSON.stringify(LaPa['PAGE']);LaPa.log('Saved fully','LocalStorage')}},'io':function(a,b,c,d,e,f){d=d?d:b;if(LaPa.STACK[d]&&!LaPa.STACK[d].queue)return;if(!LaPa.STACK[d]){if(!a||!b)return;LaPa.STACK[d]={'callback':a?a:'','url':b,'params':c,'delay':new Date().getTime(),'meta':e?e:false,'queue':f?f:false};if(f&&Object.keys(LaPa.STACK).length>0)return}if(LaPa.STACK[d].params){if(typeof LaPa.STACK[d].params!='string'){paramsLine='';for(i in LaPa.STACK[d].params){paramsLine+=i+'='+LaPa.STACK[d].params[i]+'&'}LaPa.STACK[d].params=paramsLine}}else{LaPa.STACK[d].params=''}var g;if(window.XMLHttpRequest){g=new XMLHttpRequest()}else{g=new ActiveXObject("Microsoft.XMLHTTP")}g.onreadystatechange=function(){if(g.readyState==4){response=false;if(g.status==200){response=g.responseText}LaPa.stackComplete(response,d)}};g.open('GET',LaPa.STACK[d].url+'?'+LaPa.STACK[d].params+'lapa=true&rand='+new Date().getTime(),true);g.send()},'stackComplete':function(a,b){if(!LaPa.STACK[b])return;LaPa.STACK[b].delay=new Date().getTime()-LaPa.STACK[b].delay;status=a?'Complete':'Failure';callback=LaPa.STACK[b].callback;LaPa.log(b+' '+(b==LaPa.STACK[b].url?'':'(URL: '+LaPa.STACK[b].url+') ')+status+' at '+LaPa.STACK[b].delay+'ms','LOAD');meta=null;if(LaPa.STACK[b].meta){delete LaPa.STACK[b].meta;meta=LaPa.STACK[b]}delete LaPa.STACK[b];callback(a,meta);if(Object.keys(LaPa.STACK).length>0){for(i in LaPa.STACK){if(LaPa.STACK[i].queue){LaPa.io(null,null,null,LaPa.STACK[i].key,null,false);break}}}},'script':{'clearTimers':function(){count=0;if(window.timerHandlers){for(i in timerHandlers){if(clearTimeout(timerHandlers[i]))count++}timerHandlers=[]}else{var a=setTimeout(function(){},1);for(var b=a;b>0;b--)if(clearTimeout(b))count++}LaPa.log(count+' Timeouts cleared','Navigator')},'clearIntervals':function(){count=0;if(window.intervalHandlers){for(i in intervalHandlers){if(clearInterval(intervalHandlers[i]))count++}intervalHandlers=[]}else{var a=setInterval(function(){},1);for(var b=a;b>0;b--)if(clearInterval(b))count++}LaPa.log(count+' Intervals cleared','Navigator')},'clearVars':function(){if(!LaPa.script.globalVarsList)return;currentVarsList=Object.keys(window);count=0;for(i in currentVarsList){if(currentVarsList[i]=='LaPa')continue;if(currentVarsList[i]=='count')continue;if(currentVarsList[i]=='currentVarsList')continue;if(currentVarsList[i]=='globalVarsList')continue;if(currentVarsList[i]=='page')continue;if(!LaPa.script.globalVarsList[i]){delete window[currentVarsList[i]];count++}}LaPa.log(count+' Variables zeroized','Navigator')},'clearHandlers':function(){for(i in eventHandlers){listner=eventHandlers[i];window.removeEventListener(listner.event,listner.handler,listner.phase)}LaPa.log(eventHandlers.length+' listners removed','Navigator');eventHandlers=[]},'clearWindow':function(){LaPa.script.clearHandlers();LaPa.script.clearIntervals();LaPa.script.clearTimers();LaPa.script.clearVars()},'removeFuncContainer':function(a){if(LaPa.JS[a].func){delete LaPa.JS[a].func}},'funcContainer':function(a){LaPa.JS[a].func=new Function(LaPa.JS[a].body);LaPa.JS[a].func()}},'runScript':function(a){if(!LaPa.scriptsQueue[a])return;try{if(LaPa.CONF.runScriptsAsFuncContainer){LaPa.script.funcContainer(a)}else{scriptNode=document.createElement('script');scriptNode.id=a;scriptNode.defer=true;scriptNode.text=LaPa.JS[a].body;document.head.appendChild(scriptNode)}LaPa.log(a+' Ready','SCRIPT')}catch(e){LaPa.log(a+' called Error: '+(e.message?(e.message+' on line '+e.lineNumber+':'+e.columnNumber+' in '+e.stack):e),'SCRIPT')}LaPa.JS[a].loaded=true;delete LaPa.scriptsQueue[a];if(LaPa.scriptsQueue.length==0)LaPa.buildPage()},'loadScript':function(a,b){if(!a)return;LaPa.log(b.url+' Loaded','SCRIPT');if(!LaPa.JS[b.url])LaPa.JS[b.url]={};LaPa.JS[b.url].body=a;LaPa.JS[b.url].loaded=LaPa.JS[b.url].loaded?LaPa.JS[b.url].loaded:false;LaPa.saveDB('JS');if(LaPa.JS[b.url].preparingRun)LaPa.runScript(b.url)},'unloadScript':function(a){if(LaPa.CONF.runScriptsAsFuncContainer){LaPa.script.removeFuncContainer(a)}else{scriptNode=document.getElementById(a);scriptNode.parentNode.removeChild(scriptNode)}LaPa.JS[a].loaded=false;LaPa.log(a+' unLoaded','SCRIPT')},'loadScripts':function(a){list=[];LaPa.scriptsQueue=[];for(i in LaPa.JS){if(a[i]){list[i]=true;if(LaPa.JS[i].loaded)continue;LaPa.scriptsQueue[i]=true;if(LaPa.JS[i].body){LaPa.runScript(i)}else{LaPa.JS[i].preparingRun=true;LaPa.log(i+' Downloading...','SCRIPT');LaPa.io(LaPa.loadScript,i,null,i,true)}}else{if(LaPa.JS[i].loaded)LaPa.unloadScript(i)}}for(i in a){if(list[i])continue;if(!LaPa.JS[i])LaPa.JS[i]={};LaPa.scriptsQueue[i]=true;LaPa.JS[i].preparingRun=true;LaPa.log(i+' Downloading...','SCRIPT');LaPa.io(LaPa.loadScript,i,null,i,true)}if(LaPa.scriptsQueue.length==0)LaPa.buildPage();delete list},'makeIndicator':function(a){if(LaPa.indicator){document.body.appendChild(LaPa.indicator)}else{LaPa.log('Building LaPa Indicator...','PAGE');LaPa.indiStyle="<style>.loader {font-size: 3px;position: absolute;text-indent: -9999em;border-top: 1.1em solid rgba(255, 255, 255, 0.2);border-right: 1.1em solid rgba(255, 255, 255, 0.2);border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);border-left: 1.1em solid #ffffff;-webkit-transform: translateZ(0);-ms-transform: translateZ(0);transform: translateZ(0);-webkit-animation: load8 1.1s infinite linear;animation: load8 1.1s infinite linear;}.loader,.loader:after {border-radius: 50%;width: 10em;height: 10em;}@-webkit-keyframes load8 {0% {-webkit-transform: rotate(0deg);transform: rotate(0deg);}100% {-webkit-transform: rotate(360deg);transform: rotate(360deg);}}@keyframes load8 {0% {-webkit-transform: rotate(0deg);transform: rotate(0deg);}100% {-webkit-transform: rotate(360deg);transform: rotate(360deg);}}</style>";LaPa.indicator=document.createElement('div');LaPa.indicator.id='indicator';LaPa.indicator.style.position='fixed';LaPa.indicator.style.bottom='100px';LaPa.indicator.style.right='0px';LaPa.indicator.style.width='50px';LaPa.indicator.style.maxHeight='50px';LaPa.indicator.style['backdrop-filter']='blur(5px)';LaPa.indicator.innerHTML=LaPa.indiStyle+'<div id="indicator_loader"></div><span style="position: absolute;left:7px;top: 1px;padding-right: 10px">üêæ</span>';document.body.appendChild(LaPa.indicator)}if(a)LaPa.indicatorState(a)},'indicatorState':function(a){if(!document.getElementById('indicator')){LaPa.makeIndicator(a);return}if(a=='loading')document.getElementById('indicator_loader').classList.add('loader');if(a=='ready')document.getElementById('indicator_loader').classList.remove('loader')},'parseHTML':{'modifyLinks':function(a){},'getScripts':function(a,b,c,d){c=c?c:false;scripts={};LaPa.log('Fetching Scripts...','PARSING');while(a.search('<script')>-1){script={};script['scriptTagStart']=a.search('<script');script['scriptTagEnd']=a.search('</script>');script['scriptTag']=a.substring(script['scriptTagStart'],script['scriptTagEnd']);script['scriptHeadEnd']=script['scriptTag'].search('>');script['scriptHead']=script['scriptTag'].substring('<script'.length,script['scriptHeadEnd']);script['scriptBody']=script['scriptTag'].substring(script['scriptHeadEnd']+'>'.length);if((script['scriptHead'].search('src')>-1)&&script['scriptBody'].length==0){script['scriptSrc']=script['scriptHead'].substring(script['scriptHead'].search('src'));script['scriptSrc']=script['scriptSrc'].substring(script['scriptHead'].search('"')-1);script['scriptSrc']=script['scriptSrc'].substring(0,script['scriptSrc'].search('"'));if(script['scriptSrc'].indexOf(location.host)==-1&&script['scriptSrc'].indexOf('http')==-1)if(script['scriptSrc'][0]!='/')script['scriptSrc']='/'+script['scriptSrc']}else{}id=script['scriptSrc']?script['scriptSrc']:'script_'+LaPa.rand();if((id.indexOf('lapa.js')!=-1)||(id.indexOf('lapa.pre.js')!=-1)){LaPa.log(id+' excluded!','SCRIPT')}else{scripts[id]=true;if(c){scripts[id]=script['scriptBody']==''?false:script['scriptBody']}else{if(!LaPa.JS[id])LaPa.JS[id]={'body':script['scriptBody']==''?false:script['scriptBody']};if(d)LaPa.JS[id].loaded=true;if(script['scriptSrc']&&LaPa.JS[id].body==false){LaPa.io(LaPa.loadScript,script['scriptSrc'],null,script['scriptSrc'],true)}}LaPa.log(id+' Fetched','SCRIPT')}a=a.substring(0,script['scriptTagStart'])+a.substring(script['scriptTagEnd']+'</script>'.length);delete script}LaPa.log((Object.keys(scripts).length)+' scripts found','PARSING');if(b){return{'source':a,'scripts':scripts}}return scripts},'preparePage':function(a){LaPa.log('Fetching Body, Head and Title...','PARSING');a=a.replace('<!DOCTYPE html>','');headTagStart=a.search('<head>')+'<head>'.length;headTagEnd=a.search('</head>');bodyTagStart=a.search('<body')+'<body'.length;bodyTagStart=a.substring(bodyTagStart).search('>')+bodyTagStart+'>'.length;bodyTagEnd=a.search('</body>');headTag=a.substring(headTagStart,headTagEnd);bodyTag=a.substring(bodyTagStart,bodyTagEnd);titleTagStart=headTag.search('<title>');titleTagEnd=headTag.search('</title>');titleTag=headTag.substring(titleTagStart+'<title>'.length,titleTagEnd);LaPa.log('Page '+titleTag+' Fetched','PARSING');return{'title':titleTag,'head':headTag,'body':bodyTag}},'init':function(a,b){if(b){page={'title':document.title,'head':document.head.innerHTML,'body':document.body.innerHTML,'headScripts':LaPa.parseHTML.getScripts(document.head.innerHTML,null,null,true)}}else{page=LaPa.parseHTML.preparePage(a);page.headScripts=LaPa.parseHTML.getScripts(page.head)}body=LaPa.parseHTML.getScripts(page.body,true);page.bodyScripts=body.scripts;page.body=body.source;LaPa.log('Complete','PARSING');return page}},'readyPage':function(){if(LaPa.waitList.length!=0){for(i in LaPa.waitList){LaPa.log(i+' load unFinished!','SCRIPT');delete LaPa.STACK[i]}}if(LaPa.preparingPage){LaPa.preparingPage=false;LaPa.indicatorState('ready');LaPa.log('initPage loaded','PAGE');window.dispatchEvent(LaPa.renderEvent)}},'fetchPage':function(){LaPa.indicatorState('loading');LaPa.currentPage=location.pathname;history.replaceState({'id':LaPa.currentPage},document.title,LaPa.currentPage);LaPa.initComplete=true;LaPa.preparingPage=true;LaPa.waitList=[];if(LaPa.PAGE[LaPa.currentPage]){LaPa.log(LaPa.currentPage+' is initPage, already cached','PAGE');for(i=0;i<document.getElementsByTagName('script').length;i++){id=document.getElementsByTagName('script')[i].src.split(location.host)[1];if(LaPa.JS[id]){document.getElementsByTagName('script')[i].id=id}}setTimeout(LaPa.readyPage,500)}else{LaPa.log(LaPa.currentPage+' is initPage, caching...','PAGE');LaPa.PAGE[LaPa.currentPage]=LaPa.parseHTML.init(null,true);LaPa.saveDB('PAGE');for(i=0;i<document.getElementsByTagName('script').length;i++){id=document.getElementsByTagName('script')[i].src.split(location.host)[1];if(LaPa.JS[id]){LaPa.waitList[id]=true;document.getElementsByTagName('script')[i].id=id;document.getElementsByTagName('script')[i].onload=function(){delete LaPa.waitList[id];if(LaPa.waitList.length==0)LaPa.readyPage()}}}setTimeout(LaPa.readyPage,5000)}},'loadPage':function(a,b){if(!a)return;LaPa.log(b.url+' Loaded','PAGE');page=LaPa.parseHTML.init(a);LaPa.PAGE[b.url]=page;LaPa.saveDB('PAGE');if(LaPa.preparingPage==b.url)LaPa.render(b.url)},'getPage':function(a){LaPa.log(a+' Loading...','PAGE');LaPa.io(LaPa.loadPage,a,null,a,true)},'buildPage':function(){LaPa.currentPage=LaPa.preparingPage;LaPa.preparingPage=false;page=LaPa.PAGE[LaPa.currentPage];history.pushState({'id':LaPa.currentPage},page['title'],LaPa.currentPage);document.title=page.title;document.body.innerHTML=page.body;if(window.scrollTo){window.scrollTo(0,0)}else{document.body.scrollTop=0;document.body.scrollLeft=0}LaPa.indicatorState('loading');LaPa.log('Markup ready, building Body Scripts...','PAGE');for(i in page.bodyScripts){try{if(LaPa.CONF.runScriptsAsFuncContainer){LaPa.script.funcContainer(i)}else{scriptNode=document.createElement('script');scriptNode.id=i;scriptNode.defer='defer';scriptNode.text=LaPa.JS[i].body;document.body.appendChild(scriptNode)}LaPa.log(i+' Ready','SCRIPT')}catch(e){LaPa.log(i+' called Error: '+(e.message?(e.message+' on line '+e.lineNumber+':'+e.columnNumber+' in '+e.stack):e),'SCRIPT')}}LaPa.indicatorState('ready');LaPa.log(LaPa.currentPage+' Load Complete','PAGE');window.dispatchEvent(LaPa.renderEvent)},'render':function(a){if(LaPa.CONF.runScriptsAsFuncContainer&&LaPa.CONF.legacyPages){LaPa.script.clearWindow()}else{for(i in LaPa.PAGE[LaPa.currentPage].headScripts){if(!LaPa.PAGE[a].headScripts[i]){LaPa.log('Found unused '+i+', Destroying Page...','SCRIPT');LaPa.script.clearWindow();break}}}LaPa.log('Rendering...','PAGE');LaPa.loadScripts(LaPa.PAGE[a].headScripts)},'page':function(a){if(LaPa.currentPage==a)return;if(LaPa.initComplete)LaPa.loadBegin=new Date().getTime();LaPa.log(a+' Preparing...','PAGE');LaPa.indicatorState('loading');window.dispatchEvent(LaPa.loadEvent);LaPa.preparingPage=a;if(LaPa.PAGE[a]){LaPa.render(a)}else{LaPa.getPage(a)}},'init':function(){LaPa.oldErrorHandler=window.onerror;window.onerror=LaPa.errorHandler;LaPa.loadExt();window.dispatchEvent(LaPa.loadEvent)},'onReadyBody':function(a){LaPa.readyBody=setInterval(function(){if(document.body){clearInterval(LaPa.readyBody);delete LaPa.readyBody;LaPa.log('Ready','BODY');a()}},50)}};LaPa.log('LaPa v.'+LaPa.version.major+'.'+LaPa.version.minor+' build '+LaPa.version.build);if(localStorage){LaPa['LocalStorage']=true;LaPa.log('Available','LocalStorage');if(localStorage['LaPa']==undefined||localStorage['LaPa']<((LaPa.version.major*10)+LaPa.version.minor)){localStorage.clear();localStorage['LaPa']=((LaPa.version.major*10)+LaPa.version.minor);LaPa.log('by Older version, cleared','LocalStorage')}if(localStorage['CONF']){LaPa.CONF=JSON.parse(localStorage['CONF']);LaPa.PAGE=localStorage['PAGE']?JSON.parse(localStorage['PAGE']):{};LaPa.JS=localStorage['JS']?JSON.parse(localStorage['JS']):{};LaPa.CSS=localStorage['CSS']?JSON.parse(localStorage['CSS']):{};LaPa['cache']=true;LaPa.log('Cache found, loaded','LocalStorage')}else{LaPa.saveDB('CONF');LaPa['cache']=false;LaPa.log('Cache not found, generated','LocalStorage')}}else{LaPa['LocalStorage']=false;LaPa.log('Unavailable','LocalStorage')}if(!window.native_addEventListener)native_addEventListener=addEventListener;if(!window.native_setInterval)native_setInterval=setInterval;if(!window.native_setTimeout)native_setTimeout=setTimeout;if(!window.eventHandlers)eventHandlers=[];if(!window.intervalHandlers)intervalHandlers=[];if(!window.timerHandlers)timerHandlers=[];if(window.onerror)LaPa.oldErrorHandler=window.onerror;window.onerror=LaPa.errorHandler;LaPa.loadEvent=new CustomEvent("LaPaLoad");LaPa.renderEvent=new CustomEvent("LaPaRender");window.native_addEventListener('LaPaLoad',function(){LaPa.log('LaPa called event LaPaLoad','Navigator')});window.native_addEventListener('LaPaRender',function(){LaPa.log('LaPa called event LaPaRender','Navigator')});window.native_addEventListener('DOMContentLoaded',LaPa.init());window.native_addEventListener('load',LaPa.onReadyBody(LaPa.fetchPage));window.native_addEventListener('popstate',LaPa.history,false);LaPa.script.globalVarsList=window.globalVarsList?globalVarsList:Object.keys(window)}